<!DOCTYPE html>
<html lang="en"><head>
<script src="Relaxing-Parallel-Trends_files/libs/clipboard/clipboard.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/tabby.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/popper.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Brantly Callaway">
  <meta name="dcterms.date" content="2023-10-17">
  <title>Frontiers in Difference-in-Differences</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="Relaxing-Parallel-Trends_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="Relaxing-Parallel-Trends_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Frontiers in Difference-in-Differences</h1>
  <p class="subtitle">Relaxing Parallel Trends</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Brantly Callaway 
</div>
<div class="quarto-title-author-email">
<a href="mailto:brantly.callaway@uga.edu">brantly.callaway@uga.edu</a>
</div>
        <p class="quarto-title-affiliation">
            University of Georgia
          </p>
    </div>
</div>

  <p class="date">October 17, 2023</p>
</section>
<section id="covariates-in-the-parallel-trends-assumption" class="slide level2">
<h2>Covariates in the Parallel Trends Assumption</h2>
<p>Including covariates in the parallel trends assumption can often make DID identification strategies more plausible:</p>
<div class="fragment">
<p><span class="alert-blue">Example</span></p>
<ul>
<li><p><span class="alert">Minimum wage example:</span> path of teen employment may depend on a state’s population / population growth / region of the country</p></li>
<li><p><span class="alert">Job displacement example:</span> path of earnings may depend on year’s of education / race / occupation</p></li>
</ul>
</div>
<div class="fragment">
<p>However, there are a number of new issues that can arise in this setting…</p>
<p><span class="math inline">\(\newcommand{\E}{\mathbb{E}} \newcommand{\E}{\mathbb{E}} \newcommand{\var}{\mathrm{var}} \newcommand{\cov}{\mathrm{cov}} \newcommand{\Var}{\mathrm{var}} \newcommand{\Cov}{\mathrm{cov}} \newcommand{\Corr}{\mathrm{corr}} \newcommand{\corr}{\mathrm{corr}} \newcommand{\L}{\mathrm{L}} \renewcommand{\P}{\mathrm{P}} \newcommand{\independent}{{\perp\!\!\!\perp}} \newcommand{\indicator}[1]{ \mathbf{1}\{#1\} }\)</span></p>
</div>
</section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<p><br></p>
<ol type="1">
<li><p>Limitations of TWFE Regression</p></li>
<li><p>Identification with Two Periods</p></li>
<li><p>Alternative Estimation Strategies</p></li>
<li><p>Multiple Periods</p></li>
<li><p>Minimum Wage Application</p></li>
<li><p>Dealing with “Bad” Controls</p></li>
</ol>
</section>
<section id="notation" class="slide level2">
<h2>Notation</h2>
<p>Start with the case with only two time periods</p>
<p>Only need a little bit of new notation here:</p>
<ul>
<li><p><span class="math inline">\(X_{t^*}\)</span> and <span class="math inline">\(X_{t^*-1}\)</span> — time-varying covariates</p></li>
<li><p><span class="math inline">\(Z\)</span> — time-invariant covariates</p></li>
</ul>
</section>
<section id="covariates-in-the-parallel-trends-assumption-1" class="slide level2">
<h2>Covariates in the Parallel Trends Assumption</h2>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Conditional Parallel Trends Assumption</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\E[\Delta Y_{t^*}(0) | X_{t^*}, X_{t^*-1},Z,D=1] = \E[\Delta Y_{t^*}(0) | X_{t^*}, X_{t^*-1},Z,D=0]\]</span></p>
</div>
</div>
</div>
<div class="fragment">
<p>In words: Parallel trends holds conditional on having the same covariates <span class="math inline">\((X_t,X_{t-1},Z)\)</span>.</p>
</div>
<div class="fragment">
<p><span class="alert">Minimum wage example</span> (e.g.) Parallel trends conditional on counties have the same population (like <span class="math inline">\(X_t\)</span>) and being in the same region of the country (like <span class="math inline">\(Z\)</span>)</p>
</div>
</section>
<section>
<section id="limitations-of-twfe-regressions" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Limitations of TWFE Regressions</h1>

</section>
<section id="limitations-of-twfe-regressions-1" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>In this setting, it is common to run the following TWFE regression:</p>
<p><span class="math display">\[Y_{it} = \theta_t + \eta_i + \alpha D_{it} + X_{it}'\beta + e_{it}\]</span></p>
<div class="fragment">
<p>However, there are a number of issues: <!--(most of these apply even in the friendly setting with two periods)--></p>
<p>Issue 1: Issues related to multiple periods and variation in treatment timing still arise</p>
</div>
<div class="fragment">
<p>Issue 2: Hard to allow parallel trends to depend on time-invariant covariates</p>
</div>
<div class="fragment">
<p>Issue 3: Hard to allow for covariates that could be affected by the treatment</p>
</div>
</section>
<section id="limitations-of-twfe-regressions-2" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>In this setting, it is common to run the following TWFE regression:</p>
<p><span class="math display">\[Y_{it} = \theta_t + \eta_i + \alpha D_{it} + X_{it}'\beta + e_{it}\]</span></p>
<p>However, there are a number of issues: <!--(most of these apply even in the friendly setting with two periods)--></p>
<p>Issue 4: Linearity results in mixing identification and estimation…e.g., with 2 periods <span class="math display">\[\begin{align*}
\Delta Y_{it} = \Delta \theta_t + \alpha D_{it} + \Delta X_{it}'\beta + \Delta e_{it}
\end{align*}\]</span> <span class="math inline">\(\implies\)</span> differencing out unit fixed effects can have implications about what researcher controls for</p>
<ul>
<li><p>This doesn’t matter if model for untreated potential outcomes is truly linear</p></li>
<li><p>However, if we think of linear model as an approximation, this may have meaningful implications.</p></li>
</ul>
</section>
<section id="limitations-of-twfe-regressions-3" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>Even if none of the previous 4 issues apply, <span class="math inline">\(\alpha\)</span> will still be equal to a weighted average of underlying (conditional-on-covariates) treatment effect parameters.</p>
<ul>
<li><p>The weights can be negative, and suffer from “weight reversal” (similar to the issue discussed in Sloczynski (2020) in the context of cross-sectional regressions with covaraites)</p></li>
<li><p>In other words, weights <span class="math inline">\(\alpha\)</span> is a weighted average of <span class="math inline">\(ATT(X)\)</span> where (relative to a baseline of weighting based on the distribution of <span class="math inline">\(X\)</span> for the treated group), the weights put larger weight on <span class="math inline">\(ATT(X)\)</span> for values of the covariates that are <em>uncommon</em> for the treated group relative to the untreated group and smaller weight on <span class="math inline">\(ATT(X)\)</span> for values of the covariates that are <em>common</em> for the treated group relative to the untreated group</p></li>
</ul>
<p>See Caetano and Callaway (2023) for more details</p>
</section>
<section id="identification-under-conditional-parallel-trends" class="slide level2">
<h2>Identification under Conditional Parallel Trends</h2>
<p>Under conditional parallel trends, we have that <span class="math display">\[
\begin{aligned}
ATT &amp;= \E[\Delta Y_{t^*} | D=1] - \E[\Delta Y_{t^*}(0) | D=1] \hspace{150pt}
\end{aligned}
\]</span></p>
</section>
<section id="identification-under-conditional-parallel-trends-1" class="slide level2" data-visibility="uncounted">
<h2>Identification under Conditional Parallel Trends</h2>
<p>Under conditional parallel trends, we have that <span class="math display">\[
\begin{aligned}
ATT &amp;= \E[\Delta Y_{t^*} | D=1] - \E[\Delta Y_{t^*}(0) | D=1] \hspace{150pt}\\
&amp;=\E[\Delta Y_{t^*} | D=1] - \E\Big[ \E[\Delta Y_{t^*}(0) | X, D=1] \Big| D=1\Big]
\end{aligned}
\]</span></p>
</section>
<section id="identification-under-conditional-parallel-trends-2" class="slide level2" data-visibility="uncounted">
<h2>Identification under Conditional Parallel Trends</h2>
<p>Under conditional parallel trends, we have that <span class="math display">\[
\begin{aligned}
ATT &amp;= \E[\Delta Y_{t^*} | D=1] - \E[\Delta Y_{t^*}(0) | D=1] \hspace{150pt}\\
&amp;=\E[\Delta Y_{t^*} | D=1] - \E\Big[ \E[\Delta Y_{t^*}(0) | X, D=1] \Big| D=1\Big]\\
&amp;= \E[\Delta Y_{t^*} | D=1] - \E\Big[ \underbrace{\E[\Delta Y_{t^*}(0) | X, D=0]}_{=:m_0(X)} \Big| D=1\Big]
\end{aligned}
\]</span></p>
<div class="fragment">
<p>Intuition: (i) Compare path of outcomes for treated group to (conditional on covariates) path of outcomes for untreated group, (ii) adjust for differences in the distribution of covariates between groups.</p>
</div>
<div class="fragment">
<p>This argument also require an <span class="alert">overlap condition</span></p>
<ul>
<li><p>For all possible values of the covariates, <span class="math inline">\(p(x) := \P(D=1|X=x) &lt; 1\)</span>.</p></li>
<li><p>In words: for all treated units, we can find untreated units that have the same characteristics</p></li>
</ul>
</div>
<div class="fragment">
<p>There are several possible ways to turn this identification result into an estimation strategy <span class="math inline">\(\rightarrow\)</span></p>
</div>
</section>
<section id="regression-adjustment" class="slide level2">
<h2>Regression Adjustment</h2>
<p>The challenging term to deal with in the previous expression for <span class="math inline">\(ATT\)</span> is</p>
<p><span class="math display">\[\E\Big[ \underbrace{\E[\Delta Y_{t^*}(0) | X, D=0]}_{=:m_0(X)} \Big| D=1\Big]\]</span></p>
<p>The most direct way to proceed is by proposing a model for <span class="math inline">\(m_0(X)\)</span>.</p>
<p>This expression suggests a <span class="alert">regression adjustment</span> estimator. For example, if we assume that <span class="math inline">\(m_0(X) = X'\\beta_0\)</span>, then we have that</p>
<p><span class="math display">\[ATT = \E[\Delta Y_{t^*} | D=1] - \E[X'|D=1]\beta_0\]</span></p>
<div class="fragment">
<p>and we can estimate the <span class="math inline">\(ATT\)</span> by</p>
<ul>
<li><p>Step 1: Estimate <span class="math inline">\(\beta_0\)</span> using untreated group</p></li>
<li><p>Step 2: Combine this estimate with estimates of <span class="math inline">\(\E[\Delta Y_t | D=1]\)</span> and <span class="math inline">\(\E[X'|D=1]\)</span> (using treated group) to estimate <span class="math inline">\(ATT\)</span></p></li>
</ul>
</div>
</section>
<section id="covariate-balancing" class="slide level2">
<h2>Covariate Balancing</h2>
<p>Alternatively, if we could choose <span class="alert">balancing weights</span> <span class="math inline">\(\nu_0(X)\)</span> such that the distribution of <span class="math inline">\(X\)</span> was the same in the untreated group as it is in the treated group after applying the balancing weights, then we would have that (from the second term above) <span class="math display">\[\begin{align*}
  \E\Big[ \E[\Delta Y_{t^*}(0) | X, D=0 ] \Big| D=1\Big] &amp;= \E\Big[ \nu_0(X) \E[\Delta Y_{t^*}(0) | X, D=0 ] \Big| D=0\Big] \\
  &amp;= \E[\nu_0(X) \Delta Y_{t^*}(0) | D=0]
\end{align*}\]</span> where the first equality is due to balancing weights and the second by the law of iterated expectations.</p>
<div class="fragment">
<p>The most common way to re-weight is based on the propensity score, you can show: <span class="math display">\[\begin{align*}
  \nu_0(x) = \frac{p(x)(1-p)}{(1-p(x))p}
\end{align*}\]</span> where <span class="math inline">\(p(x) = \P(D=1|X=x)\)</span> and <span class="math inline">\(p=\P(D=1)\)</span>.</p>
</div>
<div class="fragment">
<p>This is the approach suggested in Abadie (2005). In practice, you need to estimate the propensity score. The most common choices are probit or logit.</p>
</div>
</section>
<section id="doubly-robust" class="slide level2">
<h2>Doubly Robust</h2>
<p>Alternatively, you can show</p>
<p><span class="math display">\[ATT=\E\left[ \left( \frac{D}{p} - \frac{p(X)(1-D)}{(1-p(X))p} \right)(\Delta Y_t - \E[\Delta Y_t | X, D=0]) \right]\]</span></p>
<div class="fragment">
<p>This requires estimating both <span class="math inline">\(p(X)\)</span> and <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span>.</p>
</div>
<div class="fragment">
<p>Big advantage:</p>
<ul>
<li>This expression for <span class="math inline">\(ATT\)</span> is <em>doubly robust</em>. This means that, it will deliver consistent estimates of <span class="math inline">\(ATT\)</span> if <span class="alert">either</span> the model for <span class="math inline">\(p(X)\)</span> or for <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>In my experience, doubly robust estimators perform much better than either the regression or propensity score weighting estimators</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>This also provides a connection to estimating <span class="math inline">\(ATT\)</span> under conditional parallel trends using machine learning for <span class="math inline">\(p(X)\)</span> and <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span> (see: Chang (2020) and Callaway, Drukker, Liu, and Sant’Anna (2023))</li>
</ul>
</div>
<div class="fragment">
<p><a href="Relaxing-Parallel-Trends.html#/understanding-double-robustness">More Details</a></p>
</div>
</section>
<section id="multiple-time-periods-and-variation-in-treatment-timing" class="slide level2">
<h2>Multiple Time Periods and Variation in Treatment Timing</h2>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Conditional Parallel Trends with Multiple Periods</strong></p>
</div>
<div class="callout-content">
<p>For all groups <span class="math inline">\(g \in \bar{\mathcal{G}}\)</span> (all groups except the never-treated group) and for all time periods <span class="math inline">\(t=2, \ldots, \mathcal{T}\)</span>,</p>
<p><span class="math display">\[\E[\Delta Y_t(0) | \mathbf{X}, Z, G=g] = \E[\Delta Y_t(0) | \mathbf{X}, Z, U=1]\]</span></p>
<p>where <span class="math inline">\(\mathbf{X} := (X_1,X_2,\ldots,X_\mathcal{T})\)</span>.</p>
</div>
</div>
</div>
<p>Under this assumption, using similar arguments to the ones above, one can show that</p>
<p><span class="math display">\[ATT(g,t) = \E\left[ \left( \frac{\indicator{G=g}}{p_g} - \frac{p_g(\mathbf{X},Z)U}{(1-p_g(\mathbf{X},Z))p_g}\right)\Big(Y_t - Y_{g-1} - m_{gt}^0(\mathbf{X},Z)\Big) \right]\]</span></p>
<p>where <span class="math inline">\(p_g(\mathbf{X},Z) := \P(G=g|\mathbf{X},Z,\indicator{G=g}+U=1)\)</span> and <span class="math inline">\(m_{gt}^0(\mathbf{X},Z) := \E[Y_t-Y_{g-1}|\mathbf{X},Z,U=1]\)</span>.</p>
</section>
<section id="practical-considerations" class="slide level2">
<h2>Practical Considerations</h2>
<p>Because <span class="math inline">\(\mathbf{X}\)</span> contains <span class="math inline">\(X_t\)</span> for all time periods, terms like <span class="math inline">\(m_{gt}^0(\mathbf{X},Z)\)</span> can be quite high-dimensional (and hard to estimate) in many applications. In many cases, it may be reasonable to replace with lower dimensional function <span class="math inline">\(\mathbf{X}\)</span>:</p>
<div class="fragment">
<ul>
<li><span class="math inline">\(\bar{X}_i\)</span> — the average of <span class="math inline">\(X_{it}\)</span> across time periods</li>
<li><span class="math inline">\(X_{it}, X_{ig-1}\)</span> — the covariates in the current period and base period (this is possible in the <code>pte</code> package currently and may be added to <code>did</code> soon).</li>
<li><span class="math inline">\(X_{ig-1}\)</span> — the covariates in the base period (this is the default in <code>did</code>)</li>
<li><span class="math inline">\((X_{it}-X_{ig-1})\)</span> — the change in covariates over time</li>
</ul>
</div>
</section></section>
<section>
<section id="empirical-example" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Empirical Example</h1>
<aside class="notes">
<ul>
<li><p>walk through a bunch of examples</p></li>
<li><p>including covariates in the parallel trend assumtpion, compare to regression</p></li>
<li><p>regression adjustment, ipw, doubly robust</p></li>
<li><p>change base period</p></li>
<li><p>change comparison group</p></li>
<li><p>allow for anticipation</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="back-to-minimum-wage-example" class="slide level2">
<h2>Back to Minimum Wage Example</h2>
<p>We’ll allow for path of outcomes to depend on region of the country</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># run TWFE regression</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>twfe_x <span class="ot">&lt;-</span> fixest<span class="sc">::</span><span class="fu">feols</span>(lemp <span class="sc">~</span> post <span class="sc">|</span> id <span class="sc">+</span> region<span class="sc">^</span>year,</span>
<span id="cb1-3"><a href="#cb1-3"></a>                        <span class="at">data=</span>data2)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">modelsummary</span>(twfe_x, <span class="at">gof_omit=</span><span class="st">".*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">post</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.008)</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Relative to previous results, this is much smaller and statistically insignificant and is similar to the result in Dube et al.&nbsp;(2010).</p>
</section>
<section id="callaway-and-santanna-2021-results" class="slide level2">
<h2>Callaway and Sant’Anna (2021) Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb2-6"><a href="#cb2-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region,</span>
<span id="cb2-7"><a href="#cb2-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>               <span class="at">data=</span>data2)</span>
<span id="cb2-10"><a href="#cb2-10"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb2-12"><a href="#cb2-12"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="callaway-and-santanna-2021-results-1" class="slide level2">
<h2>Callaway and Sant’Anna (2021) Results</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0273        0.0077    -0.0424     -0.0121 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0436     0.0199       -0.0849     -0.0024 *
  2006  -0.0199     0.0078       -0.0360     -0.0038 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="callaway-and-santanna-2021-results-2" class="slide level2">
<h2>Callaway and Sant’Anna (2021) Results</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<p>Even more than in the previous case, the results in this case are notably different depending on the estimation strategy.</p>
</section>
<section id="add-covariates" class="slide level2">
<h2>Add Covariates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># run TWFE regression</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>twfe_x <span class="ot">&lt;-</span> fixest<span class="sc">::</span><span class="fu">feols</span>(lemp <span class="sc">~</span> post <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay <span class="sc">|</span> id <span class="sc">+</span> region<span class="sc">^</span>year,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                        <span class="at">data=</span>data2)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">modelsummary</span>(twfe_x, <span class="at">gof_omit=</span><span class="st">".*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">post</td>
<td style="text-align: center;">−0.022</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.008)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lpop</td>
<td style="text-align: center;">1.057</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.137)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lavg_pay</td>
<td style="text-align: center;">0.074</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.079)</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="regression-adjustment-1" class="slide level2">
<h2>Regression Adjustment</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="|6|9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb5-7"><a href="#cb5-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a>               <span class="at">est_method=</span><span class="st">"reg"</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>               <span class="at">data=</span>data2)</span>
<span id="cb5-11"><a href="#cb5-11"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb5-13"><a href="#cb5-13"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-adjustment-2" class="slide level2">
<h2>Regression Adjustment</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0321        0.0085    -0.0487     -0.0155 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0596     0.0214       -0.1060     -0.0131 *
  2006  -0.0197     0.0081       -0.0372     -0.0022 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Outcome Regression</code></pre>
</div>
</div>
</section>
<section id="regression-adjustment-3" class="slide level2">
<h2>Regression Adjustment</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="inverse-propensity-score-weighting" class="slide level2">
<h2>Inverse Propensity Score Weighting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="|9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb7-7"><a href="#cb7-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb7-9"><a href="#cb7-9"></a>               <span class="at">est_method=</span><span class="st">"ipw"</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>               <span class="at">data=</span>data2)</span>
<span id="cb7-11"><a href="#cb7-11"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb7-13"><a href="#cb7-13"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inverse-propensity-score-weighting-1" class="slide level2">
<h2>Inverse Propensity Score Weighting</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0313        0.0078    -0.0466      -0.016 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0514     0.0198       -0.0927     -0.0102 *
  2006  -0.0222     0.0073       -0.0374     -0.0070 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Inverse Probability Weighting</code></pre>
</div>
</div>
</section>
<section id="inverse-propensity-score-weighting-2" class="slide level2">
<h2>Inverse Propensity Score Weighting</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="doubly-robust-1" class="slide level2">
<h2>Doubly Robust</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="|9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb9-5"><a href="#cb9-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb9-7"><a href="#cb9-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>               <span class="at">est_method=</span><span class="st">"dr"</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a>               <span class="at">data=</span>data2)</span>
<span id="cb9-11"><a href="#cb9-11"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb9-13"><a href="#cb9-13"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="doubly-robust-2" class="slide level2">
<h2>Doubly Robust</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0317        0.0077    -0.0467     -0.0166 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0509     0.0182       -0.0903     -0.0114 *
  2006  -0.0230     0.0073       -0.0389     -0.0071 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="doubly-robust-3" class="slide level2">
<h2>Doubly Robust</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="change-base-period" class="slide level2">
<h2>Change base period</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-code-line-numbers="|8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb11-3"><a href="#cb11-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb11-7"><a href="#cb11-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb11-8"><a href="#cb11-8"></a>               <span class="at">base_period=</span><span class="st">"varying"</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>               <span class="at">est_method=</span><span class="st">"dr"</span>,</span>
<span id="cb11-10"><a href="#cb11-10"></a>               <span class="at">data=</span>data2)</span>
<span id="cb11-11"><a href="#cb11-11"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb11-13"><a href="#cb11-13"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="change-base-period-1" class="slide level2">
<h2>Change base period</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0317        0.0077    -0.0469     -0.0165 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0509     0.0196       -0.0923     -0.0094 *
  2006  -0.0230     0.0070       -0.0378     -0.0082 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="change-base-period-2" class="slide level2">
<h2>Change base period</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="change-comparison-group" class="slide level2">
<h2>Change comparison group</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-code-line-numbers="|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb13-3"><a href="#cb13-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb13-7"><a href="#cb13-7"></a>               <span class="at">control_group=</span><span class="st">"notyettreated"</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>               <span class="at">est_method=</span><span class="st">"dr"</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>               <span class="at">data=</span>data2)</span>
<span id="cb13-11"><a href="#cb13-11"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb13-13"><a href="#cb13-13"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="change-comparison-group-1" class="slide level2">
<h2>Change comparison group</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0312        0.0078    -0.0465     -0.0159 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0493     0.0185       -0.0886     -0.0100 *
  2006  -0.0230     0.0078       -0.0395     -0.0066 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Not Yet Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="change-comparison-group-2" class="slide level2">
<h2>Change comparison group</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="allow-for-anticipation" class="slide level2">
<h2>Allow for anticipation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-code-line-numbers="|10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># callaway and sant'anna including covariates</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>cs_x <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(<span class="at">yname=</span><span class="st">"lemp"</span>,</span>
<span id="cb15-3"><a href="#cb15-3"></a>               <span class="at">tname=</span><span class="st">"year"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>               <span class="at">idname=</span><span class="st">"id"</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>               <span class="at">gname=</span><span class="st">"G"</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>               <span class="at">xformla=</span><span class="sc">~</span>region <span class="sc">+</span> lpop <span class="sc">+</span> lavg_pay,</span>
<span id="cb15-7"><a href="#cb15-7"></a>               <span class="at">control_group=</span><span class="st">"nevertreated"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>               <span class="at">base_period=</span><span class="st">"universal"</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>               <span class="at">est_method=</span><span class="st">"dr"</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>               <span class="at">anticipation=</span><span class="dv">1</span>,</span>
<span id="cb15-11"><a href="#cb15-11"></a>               <span class="at">data=</span>data2)</span>
<span id="cb15-12"><a href="#cb15-12"></a>cs_x_res <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"group"</span>)</span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="fu">summary</span>(cs_x_res)</span>
<span id="cb15-14"><a href="#cb15-14"></a>cs_x_dyn <span class="ot">&lt;-</span> <span class="fu">aggte</span>(cs_x, <span class="at">type=</span><span class="st">"dynamic"</span>)</span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="fu">ggdid</span>(cs_x_dyn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="allow-for-anticipation-1" class="slide level2">
<h2>Allow for anticipation</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
    ATT    Std. Error     [ 95%  Conf. Int.] 
 -4e-04        0.0087    -0.0175      0.0166 


Group Effects:
 Group Estimate Std. Error [95% Pointwise  Conf. Band] 
  2006   -4e-04     0.0098         -0.0196      0.0188 
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  1
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="allow-for-anticipation-2" class="slide level2">
<h2>Allow for anticipation</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="covariates-affected-by-the-treatment" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Covariates Affected by the Treatment</h1>

</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<p>So far, our discussion has been for the case where the time-varying covariates <span class="alert">evolve exogenously</span>.</p>
<ul>
<li>Many (probably most) covariates fit into this category: in the minimum wage example, a county’s population probably fits here.</li>
</ul>
<p>But in other cases, there can exist covariates that we would like to include in the parallel trends assumption that could be affected by the treatment (this type of covariate is often referred to as a <span class="alert">bad control</span>.</p>
<ul>
<li>Example: Job displacement
<ul>
<li>Path of earnings (in the absence of job displacement) likely depends on occupation, industry, and/or union status, which could all be affected by job displacement</li>
</ul></li>
</ul>
<p>The traditional approach in empirical work is to completely drop covariates that could have been affected by the treatment.</p>
<ul>
<li>Not clear if this is the right idea though…</li>
</ul>
</section>
<section id="additional-notation" class="slide level2">
<h2>Additional Notation</h2>
<p>To wrap our heads around this, let’s go back to the case with two time periods.</p>
<p>Define treated and untreated <span class="alert">potential covariates</span>: <span class="math inline">\(X_{it}(1)\)</span> and <span class="math inline">\(X_{it}(0)\)</span>. Notice that in the “textbook” two period setting, we observe <span class="math display">\[X_{it^*} = D_i X_{it^*}(1) + (1-D_i) X_{it^*}(0) \qquad \textrm{and} \qquad X_{it^*-1} = X_{it^*-1}(0)\]</span></p>
<p>If the covariates are literally not affected by the treatment at all, then we can write the version of conditional parallel trends that we have been using above in terms of potential outcomes:</p>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Conditional Parallel Trends using Untreated Potential Covariates</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\E[\Delta Y_{t^*}(0) | X_{t^*}(0), X_{t^*-1}(0), Z, D=1] = \E[\Delta Y_{t^*}(0) | X_{t^*}(0), X_{t^*-1}(0), Z, D=0]\]</span></p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="alternative-identification-strategies" class="slide level2">
<h2>Alternative Identification Strategies</h2>
<p>One idea is to just ignore that the covariates may have been affected by the treatment:</p>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Alternative Conditional Parallel Trends 1</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\E[\Delta Y_{t^*}(0) | X_{t^*}, X_{t^*-1}(0), Z, D=1] = \E[\Delta Y_{t^*}(0) |  X_{t^*}, X_{t^*-1}(0), Z, D=0]\]</span></p>
</div>
</div>
</div>
<p><br></p>
<p>The limitations of this approach are well known (even discussed in MHE), and this is not typically the approach taken in empirical work</p>
</section>
<section id="alternative-identification-strategies-1" class="slide level2">
<h2>Alternative Identification Strategies</h2>
<p>It is more common in empirical work to drop <span class="math inline">\(X_t(0)\)</span> entirely from the parallel trends assumption</p>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Alternative Conditional Parallel Trends 2</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\E[\Delta Y_{t^*}(0) | Z, D=1] = \E[\Delta Y_{t^*}(0) |  Z, D=0]\]</span></p>
</div>
</div>
</div>
<p><br></p>
<p>In my view, this is not attractive either though. If we believe this assumption, then we have basically solved the bad control problem by assuming that it does not exist.</p>
</section>
<section id="alternative-identification-strategies-2" class="slide level2">
<h2>Alternative Identification Strategies</h2>
<p>Perhaps a better alternative identifying assumption is the following one</p>
<p><br></p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Alternative Conditional Parallel Trends 3</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\E[\Delta Y_{t^*}(0) | X_{t^*-1}(0), Z, D=1] = \E[\Delta Y_{t^*}(0) |  X_{t^*-1}(0), Z, D=0]\]</span></p>
</div>
</div>
</div>
<p><br></p>
<p>This says that:</p>
<ul>
<li><p>Conditional parallel trends holds after conditioning on pre-treatment time-varying covariates that could have been affected by treatment</p></li>
<li><p>It is not the same identifying assumption as the one that we started with, but we are at least allowing for the bad control to show up in the identifying assumption</p></li>
<li><p>Since <span class="math inline">\(X_{t^*-1}(0)\)</span> is observed for all units, we can immediately operationalize this assumption use our arguments from earlier (i.e., the ones without bad controls)</p></li>
<li><p>In practice, you can just include the bad control among other covariates in <code>did</code></p></li>
</ul>
</section>
<section id="identification-under-cpt" class="slide level2">
<h2>Identification under CPT</h2>
<p>Going back to the original conditional parallel trends assumption (that include both <span class="math inline">\(X_{t^*}(0)\)</span> and <span class="math inline">\(X_{t^*-1}(0)\)</span>)…Using the same sort of arguments as for regression adjustment earlier, it follows that</p>
<p><span class="math display">\[ATT = \E[\Delta Y_{t^*} | D=1] - \E\Big[ \E[\Delta Y_{t^*}(0) | X_{t^*}(0), X_{t^*-1}(0), Z, D=0] \Big| D=1\Big]\]</span></p>
<p>Here:</p>
<ul>
<li><p>The inside conditional expectation is identified — we see untreated potential outcomes and covariates for the untreated group</p></li>
<li><p>But the outside expectation is infeasible <span class="math inline">\(\implies\)</span> we are stuck</p></li>
</ul>
</section>
<section id="dealing-with-x_t0" class="slide level2">
<h2>Dealing with <span class="math inline">\(X_{t^*}(0)\)</span></h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Covariate Unconfoundedness Assumption</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[X_{t^*}(0) \independent D | X_{t^*-1}(0), Z\]</span></p>
</div>
</div>
</div>
<p><span class="alert">Intuition:</span> For the treated group, the time-varying covariate would have evolved in the same way over time as it actually did for the untreated group, conditional on <span class="math inline">\(X_{t^*-1}\)</span> and <span class="math inline">\(Z\)</span>.</p>
<ul>
<li><p>Notice that this assumption only concerns untreated potential covariates <span class="math inline">\(\implies\)</span> it allows for <span class="math inline">\(X_{t^*}\)</span> to be affected by the treatment</p></li>
<li><p>Making an assumption like this indicates that <span class="math inline">\(X_{t^*}(0)\)</span> is playing a dual role: (i) start by treating it as if it’s an outcome, (ii) have it continue to play a role as a covariate</p></li>
</ul>
<p>Under this assumption, can show that we can recover the <span class="math inline">\(ATT\)</span>:</p>
<p><span class="math display">\[ATT = \E[\Delta Y_{t^*} | D=1] - \E\left[ \E[\Delta Y_{t^*} | X_{t^*-1}, Z, D=0] \Big| D=1 \right]\]</span></p>
</section>
<section id="additional-discussion" class="slide level2">
<h2>Additional Discussion</h2>
<p>In some cases, it may make sense to condition on other additional variables (e.g., the lagged outcome <span class="math inline">\(Y_{t^*-1}\)</span>) in the covariate unconfoundedness assumption. In this case, it is still possible to identify <span class="math inline">\(ATT\)</span>, but it is more complicated</p>
<p>It could also be possible to use alternative identifying assumptions besides covariate unconfoundedness — at a high-level, we somehow need to recover the distribution of <span class="math inline">\(X_{t^*}(0)\)</span></p>
<ul>
<li>e.g., Brown, Butts, and Westerlund (2023)</li>
</ul>
<p>See Caetano et al.&nbsp;(2023) for more details about bad controls.</p>
</section></section>
<section>
<section id="appendix" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Appendix</h1>

</section>
<section id="understanding-double-robustness" class="slide level2" data-visibility="uncounted">
<h2>Understanding Double Robustness</h2>
<p>To understand double robustness, we can rewrite the expression for <span class="math inline">\(ATT\)</span> as <span class="math display">\[\begin{align*}
  ATT = \E\left[ \frac{D}{p} \Big(\Delta Y_{t^*} - m_0(X)\Big) \right] - \E\left[ \frac{p(X)(1-D)}{(1-p(X))p} \Big(\Delta Y_{t^*} - m_0(X)\Big)\right]
\end{align*}\]</span></p>
<p>The first term is exactly the same as what comes from regression adjustment</p>
<ul>
<li><p>If we correctly specify a model for <span class="math inline">\(m_0(X)\)</span>, it will be equal to <span class="math inline">\(ATT\)</span>.</p></li>
<li><p>If <span class="math inline">\(m_0(X)\)</span> not correctly specified, then, by itself, this term will be biased for <span class="math inline">\(ATT\)</span></p></li>
</ul>
<p>The second term can be thought of as a de-biasing term</p>
<ul>
<li><p>If <span class="math inline">\(m_0(X)\)</span> is correctly specified, it is equal to 0</p></li>
<li><p>If <span class="math inline">\(p(X)\)</span> is correctly specified, it reduces to <span class="math inline">\(\E[\Delta Y_t(0) | D=1] - \E[m_0(X)|D=1]\)</span> which both delivers counterfactual untreated potential outcomes and removes the (possibly misspecified) second term from the first equation</p></li>
</ul>
<p><a href="Relaxing-Parallel-Trends.html#/doubly-robust">Back</a></p>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>