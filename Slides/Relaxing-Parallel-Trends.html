<!DOCTYPE html>
<html lang="en"><head>
<script src="Relaxing-Parallel-Trends_files/libs/clipboard/clipboard.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/tabby.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/popper.min.js"></script>
<script src="Relaxing-Parallel-Trends_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Relaxing-Parallel-Trends_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Brantly Callaway">
  <meta name="dcterms.date" content="2023-10-05">
  <title>Frontiers in Difference-in-Differences</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="Relaxing-Parallel-Trends_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="Relaxing-Parallel-Trends_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="Relaxing-Parallel-Trends_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Frontiers in Difference-in-Differences</h1>
  <p class="subtitle">Relaxing Parallel Trends</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Brantly Callaway <a href="https://orcid.org/0000-0000-0000-0000" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:brantly.callaway@uga.edu">brantly.callaway@uga.edu</a>
</div>
        <p class="quarto-title-affiliation">
            University of Georgia
          </p>
    </div>
</div>

  <p class="date">October 5, 2023</p>
</section>
<section id="more-complicated-treatment-regimes" class="slide level2">
<h2>More Complicated Treatment Regimes</h2>
<div class="fragment">
<p>The arguments above are fairly easy and well-known.</p>
</div>
<div class="fragment">
<p>Most applications, however, involve more complicated settings (more periods, more complicated treatment regimes, etc.)</p>
</div>
<div class="fragment">
<p>One of the most active areas in causal inference with panel data in the past few years has been to these more “realistic” settings</p>
</div>
<div class="fragment">
<p>A lot of these advancements have been in a DID framework (so I will emphasize this below)</p>
<ul>
<li><p>However, I think that a lot of the same insights apply to other identification strategies as well</p></li>
<li><p>I’ll make the case that you can just “substitute in”, say, LO unconfoundedness in the “first step” for parallel trends, and a lot of the same arguments go through</p></li>
<li><p>If we have time, I’ll argue that you can use other identification strategies in the “first step” such as interactive fixed effects models and change-in-changes</p></li>
</ul>
</div>
<div class="fragment">
<p>The first more complicated treatment regime that we’ll discuss is <span class="alert">staggered treatment adoption</span></p>
</div>
</section>
<section id="setup-w-staggered-treatment-adoption" class="slide level2">
<h2>Setup w/ Staggered Treatment Adoption</h2>
<ul>
<li><span class="math inline">\(\mathcal{T}\)</span> time periods</li>
</ul>
<div class="fragment">
<ul>
<li><p>Units can become treated at different points in time</p>
<ul>
<li><p><span class="alert-blue">staggered treatment adoption:</span> Once a unit becomes treated they remain treated.</p></li>
<li><p><span class="math inline">\(D_{it}\)</span> - treatment indicator. In math, staggered treatment adoption means: <span class="math inline">\(D_{it-1}=1 \implies D_{it}=1\)</span>.</p></li>
<li><p><span class="math inline">\(G_i\)</span> - a unit’s <span class="alert-blue">group</span> - the time period that unit becomes treated. Also, define <span class="math inline">\(U_i=1\)</span> for never-treated units and <span class="math inline">\(U_i=0\)</span> otherwise.</p></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p><span class="alert">Examples:</span></p>
<ul>
<li><p>Government policies that roll out in different locations at different times (minimum wage is close to this over short time horizons)</p></li>
<li><p>“Scarring” treatments: e.g., job displacement does not typically happen year after year, but rather labor economists think of being displaced as changing a person’s “state” (the treatment is more like: has a person ever been displaced)</p></li>
</ul>
</div>
</section>
<section id="setup-w-staggered-treatment-adoption-1" class="slide level2">
<h2>Setup w/ Staggered Treatment Adoption</h2>
<ul>
<li>Potential outcomes: <span class="math inline">\(Y_{it}(g)\)</span> - the outcome that unit <span class="math inline">\(i\)</span> would experience in time period <span class="math inline">\(t\)</span> if they became treated in period <span class="math inline">\(g\)</span>.</li>
</ul>
<div class="fragment">
<ul>
<li>Untreated potential outcome: <span class="math inline">\(Y_{it}(0)\)</span> - the outcome unit <span class="math inline">\(i\)</span> would experience in time period <span class="math inline">\(t\)</span> if they did not participate in the treatment in any period.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Observed outcome: <span class="math inline">\(Y_{it}=Y_{it}(G_i)\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>No anticipation condition: <span class="math inline">\(Y_{it} = Y_{it}(0)\)</span> for all <span class="math inline">\(t &lt; G_i\)</span> (pre-treatment periods for unit <span class="math inline">\(i\)</span>)</li>
</ul>
</div>
</section>
<section id="unit-level-treatment-effects" class="slide level2">
<h2>Unit-Level Treatment Effects</h2>
<p><span class="alert">Unit-level treatment effect</span> <span class="math display">\[\tau_{it}(g) = Y_{it}(g) - Y_{it}(0)\]</span></p>
<div class="fragment">
<p><span class="alert">Average treatment effect for unit <span class="math inline">\(i\)</span></span> (across time periods): <span class="math display">\[\bar{\tau}_i(g) = \frac{1}{\mathcal{T} - g + 1} \sum_{t=g}^{\mathcal{T}} \tau_{it}(g)\]</span></p>
</div>
</section>
<section id="target-parameters" class="slide level2">
<h2>Target Parameters</h2>
<ul>
<li><span class="alert">Group-time average treatment effects</span> <span class="math display">\[\begin{align*}
ATT(g,t) = \E[ \tau_{it}(G) | G=g]
\end{align*}\]</span> Explanation: <span class="math inline">\(ATT\)</span> for group <span class="math inline">\(g\)</span> in time period <span class="math inline">\(t\)</span></li>
</ul>
<div class="fragment">
<ul>
<li><p><span class="alert">Event Study</span> <span class="math display">\[\begin{align*}
ATT^{ES}(e) = \E[\tau_{i,g+e}(G) | G \in \mathcal{G}_e]
\end{align*}\]</span> where <span class="math inline">\(\mathcal{G}_e\)</span> is the set of groups observed to have experienced the treatment for <span class="math inline">\(e\)</span> periods at some point.</p>
<p>Explanation: <span class="math inline">\(ATT\)</span> when units have been treated for <span class="math inline">\(e\)</span> periods</p></li>
</ul>
<!--In math: $\mathcal{G}_e = \{g : (g+e) \in [2,T] \textrm{ and } g > 0\}$-->
</div>
<div class="fragment">
<ul>
<li><span class="alert">Overall ATT</span> <span class="math display">\[\begin{align*}
ATT^O = \E[\bar{\tau}_i(G) | U=0]
\end{align*}\]</span> Explanation: <span class="math inline">\(ATT\)</span> across all units that every participate in the treatment</li>
</ul>
</div>
</section>
<section id="target-parameters-1" class="slide level2">
<h2>Target Parameters</h2>
<p>To understand the discussion later, it is also helpful to think of <span class="math inline">\(ATT(g,t)\)</span> as a <span class="alert">building block</span> for the other parameters discussed above.</p>
<div class="fragment">
<p>Notice that:</p>
<p><span class="math display">\[\begin{align*}
  ATT^{ES}(e) = \sum_{g \in \bar{\mathcal{G}}} w^{ES}(g,e) ATT(g,g+e) \qquad \textrm{ and } \qquad ATT^O = \sum_{g \in \bar{\mathcal{G}}} \sum_{t=g}^{\mathcal{T}} w^O(g,t) ATT(g,t)
\end{align*}\]</span> where <span class="math display">\[\begin{align*}
  w^{ES}(g,e) = \indicator{g \in \mathcal{G}_e} \P(G=g|G\in \mathcal{G}_e) \qquad \textrm{and} \qquad
w^O(g,t) = \frac{\P(G=g|U=0)}{\mathcal{T}-g+1}
\end{align*}\]</span></p>
</div>
<div class="fragment">
<p><br></p>
<p>In other words, if we can identify/recover <span class="math inline">\(ATT(g,t)\)</span>, then we can proceed to recover <span class="math inline">\(ATT^{ES}(e)\)</span> and <span class="math inline">\(ATT^O\)</span>.</p>
</div>
</section>
<section id="did-identification-of-attgt" class="slide level2">
<h2>DID Identification of <span class="math inline">\(ATT(g,t)\)</span></h2>
<h4 id="multiple-period-version-of-parallel-trends-assumption">Multiple Period Version of Parallel Trends Assumption</h4>
<p>For all groups <span class="math inline">\(g \in \bar{\mathcal{G}}\)</span> (all groups except the never-treated group) and for all time periods <span class="math inline">\(t=2,\ldots,\mathcal{T}\)</span>, <span class="math display">\[\begin{align*}
  \E[\Delta Y_{t}(0) | G=g] = \E[\Delta Y_{t}(0) | U=1]
\end{align*}\]</span></p>
<p><br></p>
<div class="fragment">
<p>Using very similar arguments as before, can show that <span class="math display">\[\begin{align*}
  ATT(g,t) = \E[Y_t - Y_{g-1} | G=g] - \E[Y_t - Y_{g-1} | U=1]
\end{align*}\]</span></p>
</div>
<p>where the main difference is that we use <span class="math inline">\((g-1)\)</span> as the “base period” (this is the period right before group <span class="math inline">\(g\)</span> becomes treated).</p>
<p>class: inverse, middle, center count: false</p>
</section>
<section>
<section id="empirical-example-minimum-wages-and-employment" class="title-slide slide level1 center">
<h1>Empirical Example: Minimum Wages and Employment</h1>

</section>
<section id="example-minimum-wage" class="slide level2">
<h2>Example: Minimum Wage</h2>
<ul>
<li>Use county-level data from 2003-2007 during a period where the federal minimum wage was flat</li>
</ul>
<div class="fragment">
<ul>
<li><p>Exploit minimum wage changes across states</p>
<ul>
<li>Any state that increases their minimum wage above the federal minimum wage will be considered as treated</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Interested in the effect of the minimum wage on teen employment</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>We’ll also make a number of simplifications:</p>
<ul>
<li><p>Not worry much about issues like clustered standard errors</p></li>
<li><p>Not worry about variation in the amount of the minimum wage change (or whether it keeps changing) across states</p></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p><span class="alert">Goal: </span> How much do the issues that we have been talking about matter in practice?</p>
</div>
</section>
<section id="code" class="slide level2">
<h2>Code</h2>
<p>Full code is available on my website: <a href="https://bcallaway11.github.io/files/presentations/northwestern-causal-inference-workshop">https://bcallaway11.github.io/files/presentations/northwestern-causal-inference-workshop</a> or link is on my homepage <a href="https://www.brantlycallaway.com">brantlycallaway.com</a></p>
<p><span class="alert">R packages used in empirical example</span></p>
</section>
<section id="setup-data" class="slide level2">
<h2>Setup Data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      id year    G     lemp     lpop region
554 8003 2001 2007 5.556828 9.614137      4
555 8003 2002 2007 5.356586 9.623972      4
556 8003 2003 2007 5.389072 9.620859      4
557 8003 2004 2007 5.356586 9.626548      4
558 8003 2005 2007 5.303305 9.637958      4
559 8003 2006 2007 5.342334 9.633056      4</code></pre>
</div>
</div>
<p>name: twfe-results</p>
</section>
<section id="twfe-regression" class="slide level2">
<h2>TWFE Regression</h2>
<div class="cell">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">post</td>
<td style="text-align: center;">−0.038</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.008)</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><br></p>
<p>[<a href="#/lo-results">LO Unconfoundedness Results</a>]</p>
</section>
<section id="attgt-callaway-and-santanna" class="slide level2">
<h2><span class="math inline">\(ATT(g,t)\)</span> (Callaway and Sant’Anna)</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             term group time    estimate   std.error
1  ATT(2004,2003)  2004 2003  0.00000000          NA
2  ATT(2004,2004)  2004 2004 -0.03266653 0.020683512
3  ATT(2004,2005)  2004 2005 -0.06827991 0.020984873
4  ATT(2004,2006)  2004 2006 -0.12335404 0.021207710
5  ATT(2004,2007)  2004 2007 -0.13109136 0.023426419
6  ATT(2006,2003)  2006 2003 -0.03408910 0.011720023
7  ATT(2006,2004)  2006 2004 -0.01669977 0.008425207
8  ATT(2006,2005)  2006 2005  0.00000000          NA
9  ATT(2006,2006)  2006 2006 -0.01939335 0.009205517
10 ATT(2006,2007)  2006 2007 -0.06607568 0.009571189</code></pre>
</div>
</div>
</section>
<section id="plot-attgts" class="slide level2">
<h2>Plot <span class="math inline">\(ATT(g,t)\)</span>’s</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="compute-atto" class="slide level2">
<h2>Compute <span class="math inline">\(ATT^O\)</span></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
did::aggte(MP = attgt, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0571        0.0086    -0.0739     -0.0403 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0888     0.0193       -0.1318     -0.0459 *
  2006  -0.0427     0.0078       -0.0602     -0.0253 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<p>The differences between the CS estimates and the TWFE estimates are fairly large here: the CS estimate is about 50% larger than the TWFE estimate, though results are qualitatively similar.</p>
<div class="fragment">
<p><span class="alert">Let’s see if we can figure out what’s going on…</span></p>
</div>
</section>
<section id="de-chaisemartin-and-dhaultfoeuille-weights" class="slide level2">
<h2>de Chaisemartin and d’Haultfoeuille weights</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="atto-weights" class="slide level2">
<h2><span class="math inline">\(ATT^O\)</span> weights</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="weight-comparison" class="slide level2">
<h2>Weight Comparison</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="discussion" class="slide level2">
<h2>Discussion</h2>
<p>To summarize: <span class="math inline">\(ATT^O = -0.057\)</span> while <span class="math inline">\(\alpha^{TWFE} = -0.038\)</span>. This difference can be fully accounted for</p>
<ul>
<li><p>Pre-treatment differences in paths of outcomes across groups: explains about 64% of the difference</p></li>
<li><p>Differences in weights applied to the same post-treatment <span class="math inline">\(ATT(g,t)\)</span>: explains about 36% of the difference. [If you apply the post-treatment weights and “zero out” pre-treatment differences, the estimate would be <span class="math inline">\(-0.050\)</span>.]</p></li>
</ul>
<div class="fragment">
<p>In my experience: this is fairly representative of how much new DID approaches matter relative to TWFE regressions. It does not seem like “catastrophic failure” of TWFE, but (in my view) these are meaningful differences (and, e.g., given slightly different <span class="math inline">\(ATT(g,t)\)</span>’s, the difference in the weighting schemes could change the qualitative results).</p>
<ul>
<li>Of course, this whole discussion hinges crucially on how much treatment effect heterogeneity there is. More TE Het <span class="math inline">\(\implies\)</span> more sensitivity to weighting schemes [just looking at TWFE regression does not give insight into how much TE Het there is.]</li>
</ul>
</div>
</section>
<section id="additional-comments" class="slide level2">
<h2>Additional Comments</h2>
<p>One more comment: there is a lot concern about negative weights (both in econometrics and empirical work).</p>
<ul>
<li><p>There were no negative weights in the example above, but the weights still weren’t great.</p>
<ul>
<li>No negative weights does rule out “sign reversal”</li>
</ul></li>
<li><p>But, in my view, the more important issue is the non-transparent weighting scheme.</p>
<ul>
<li><p>Example 1: If you try using <code>data3</code> (the data that includes <span class="math inline">\(G=2007\)</span>), you will get a negative weight on <span class="math inline">\(ATT(g=2004,t=2007)\)</span>. But it turns out not to matter much, and TWFE works better in this case than in the case that I showed you.</p></li>
<li><p>Example 2: Alternative treatment effect parameter <span class="math inline">\(\rightarrow\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="simple-aggregation" class="slide level2">
<h2>“Simple” Aggregation</h2>
<p>Consider the following alternative aggregated treatment effect parameter <span class="math display">\[\begin{align*}
  ATT^{simple} := \sum_{t=g}^\mathcal{T} ATT(g,t) \frac{\P(G=g | G \in \bar{\mathcal{G}})}{\sum_{t=g}^{\mathcal{T}} \P(G=g| G \in \bar{\mathcal{G}})}
\end{align*}\]</span> Consider imputation so that you have <span class="math inline">\(Y_{it}-\hat{Y}_{it}(0)\)</span> available in all periods. This is the <span class="math inline">\(ATT\)</span> parameter that you get by averaging all of those.</p>
<div class="fragment">
<p>Relative to <span class="math inline">\(ATT^O\)</span>, early treated units get more weight (because we have more <span class="math inline">\(Y_{it}-\hat{Y}_{it}(0)\)</span> for them).</p>
</div>
<div class="fragment">
<p>By construction, weights are all positive. However, they are different from <span class="math inline">\(ATT^O\)</span> weights</p>
</div>
</section>
<section id="simple-aggregation-1" class="slide level2">
<h2>“Simple” Aggregation</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="simple-aggregation-2" class="slide level2">
<h2>“Simple” Aggregation</h2>
<p>Besides the violations of parallel trends in pre-treatment periods, these weights are further away from <span class="math inline">\(ATT^O\)</span> than the TWFE regression weights are!</p>
<div class="fragment">
<p>In fact, you calculate <span class="math inline">\(ATT^{simple} = -0.065\)</span> (13% larger in magnitude that <span class="math inline">\(ATT^O\)</span>)</p>
</div>
<div class="fragment">
<p>Finally, if you are “content with” non-negative weights, then you can get any summary measure from <span class="math inline">\(-0.019\)</span> (the smallest <span class="math inline">\(ATT(g,t)\)</span>) to <span class="math inline">\(-0.13\)</span> (the largest). This is a wide range of estimates.</p>
</div>
<div class="fragment">
<p>In my view, the discussion above suggests that clearly stating a target aggregate treatment effect parameter and choosing weights that target that parameter is probably more important than checking for negative weights</p>
</div>
</section></section>
<section>
<section id="covariates-in-the-parallel-trends-assumption" class="title-slide slide level1 center">
<h1>Covariates in the Parallel Trends Assumption</h1>
<p><span id="covs"></span></p>
</section>
<section id="covariates-in-the-parallel-trends-assumption-1" class="slide level2">
<h2>Covariates in the Parallel Trends Assumption</h2>
<h4 id="conditional-parallel-trends-assumption">Conditional Parallel Trends Assumption</h4>
<p>For all time periods,</p>
<p><span class="math display">\[\E[\Delta Y_t(0) | X_t, X_{t-1},Z,D=1] = \E[\Delta Y_t(0) | X_t, X_{t-1},Z,D=0]\]</span></p>
<div class="fragment">
<p>In words: Parallel trends holds conditional on having the same covariates <span class="math inline">\(X\)</span>.</p>
</div>
<div class="fragment">
<p>Minimum wage example: path of teen employment may depend on a state’s population / population growth / region of the country</p>
<p>Job displacement example: path of earnings may depend on year’s of education / race / occupation</p>
</div>
</section>
<section id="limitations-of-twfe-regressions" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>In this setting, it is common to run the following TWFE regression:</p>
<p><span class="math display">\[Y_{it} = \theta_t + \eta_i + \alpha D_{it} + X_{it}'\beta + e_{it}\]</span></p>
<div class="fragment">
<p>However, there are a number of issues: <!--(most of these apply even in the friendly setting with two periods)--></p>
<p>Issue 1: Issues related to multiple periods and variation in treatment timing still arise</p>
</div>
<div class="fragment">
<p>Issue 2: Hard to allow parallel trends to depend on time-invariant covariates</p>
</div>
<div class="fragment">
<p>Issue 3: Hard to allow for covariates that could be affected by the treatment</p>
</div>
</section>
<section id="limitations-of-twfe-regressions-1" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>In this setting, it is common to run the following TWFE regression:</p>
<p><span class="math display">\[Y_{it} = \theta_t + \eta_i + \alpha D_{it} + X_{it}'\beta + e_{it}\]</span></p>
<p>However, there are a number of issues: <!--(most of these apply even in the friendly setting with two periods)--></p>
<p>Issue 4: Linearity results in mixing identification and estimation…e.g., with 2 periods <span class="math display">\[\begin{align*}
\Delta Y_{it} = \Delta \theta_t + \alpha D_{it} + \Delta X_{it}'\beta + \Delta e_{it}
\end{align*}\]</span> <span class="math inline">\(\implies\)</span> differencing out unit fixed effects can have implications about what researcher controls for</p>
<ul>
<li><p>This doesn’t matter if model for untreated potential outcomes is truly linear</p></li>
<li><p>However, if we think of linear model as an approximation, this may have meaningful implications.</p></li>
</ul>
</section>
<section id="limitations-of-twfe-regressions-2" class="slide level2">
<h2>Limitations of TWFE Regressions</h2>
<p>Even if none of the previous 4 issues apply, <span class="math inline">\(\alpha\)</span> will still be equal to a weighted average of underlying (conditional-on-covariates) treatment effect parameters.</p>
<ul>
<li><p>The weights can be negative, and suffer from “weight reversal” (as discussed in Sloczynski (2020))</p></li>
<li><p>In other words, weights <span class="math inline">\(\alpha\)</span> is a weighted average of <span class="math inline">\(ATT(X)\)</span> where (relative to a baseline of weighting based on the distribution of <span class="math inline">\(X\)</span> for the treated group), the weights put larger weight on <span class="math inline">\(ATT(X)\)</span> for values of the covariates that are <em>uncommon</em> for the treated group relative to the untreated group and smaller weight on <span class="math inline">\(ATT(X)\)</span> for values of the covariates that are <em>common</em> for the treated group relative to the untreated group</p></li>
</ul>
<p>See Caetano and Callaway (2023) for more details</p>
</section>
<section id="covariate-balancing" class="slide level2">
<h2>Covariate Balancing</h2>
<p>Alternatively, if we could choose “balancing weights” <span class="math inline">\(\nu_0(X)\)</span> such that the distribution of <span class="math inline">\(X\)</span> was the same in the untreated group as it is in the treated group after applying the balancing weights, then we would have that (from the second term above) <span class="math display">\[\begin{align*}
  \E\Big[ \E[\Delta Y_{it}(0) | X_i, D_i=0 ] \Big| D_i=1\Big] &amp;= \E\Big[ \nu_0(X_i) \E[\Delta Y_{it}(0) | X_i, D_i=0 ] \Big| D_i=0\Big] \\
  &amp;= \E[\nu_0(X_i) \Delta Y_{it}(0) | D_i=0]
\end{align*}\]</span> where the first equality is due to balancing weights and the second by the law of iterated expectations.</p>
<div class="fragment">
<p>The most common way to re-weight is based on the propensity score, you can show: <span class="math display">\[\begin{align*}
  \nu_0(x) = \frac{p(x)(1-p)}{(1-p(x))p}
\end{align*}\]</span> where <span class="math inline">\(p(x) = \P(D=1|X=x)\)</span> and <span class="math inline">\(p=\P(D=1)\)</span>.</p>
</div>
<div class="fragment">
<p>This is the approach suggested in Abadie (2005). In practice, you need to estimate the propensity score. The most common choices are probit or logit.</p>
</div>
</section>
<section id="doubly-robust" class="slide level2">
<h2>Doubly Robust</h2>
<p>Alternatively, you can show</p>
<p><span class="math display">\[ATT=\E\left[ \left( \frac{D}{p} - \frac{p(X)(1-D)}{(1-p(X))p} \right)(\Delta Y_t - \E[\Delta Y_t | X, D=0]) \right]\]</span></p>
<div class="fragment">
<p>This requires estimating both <span class="math inline">\(p(X)\)</span> and <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span>.</p>
</div>
<div class="fragment">
<p>Big advantage:</p>
<ul>
<li>This expression for <span class="math inline">\(ATT\)</span> is <em>doubly robust</em>. This means that, it will deliver consistent estimates of <span class="math inline">\(ATT\)</span> if <span class="alert">either</span> the model for <span class="math inline">\(p(X)\)</span> or for <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>In my experience, doubly robust estimators perform much better than either the regression or propensity score weighting estimators</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>This also provides a connection to estimating <span class="math inline">\(ATT\)</span> under conditional parallel trends using machine learning for <span class="math inline">\(p(X)\)</span> and <span class="math inline">\(\E[\Delta Y_{t^*}|X,D=0]\)</span> (see: Chang (2020) and Callaway, Drukker, Liu, and Sant’Anna (2023))</li>
</ul>
</div>
</section>
<section id="additional-comments-1" class="slide level2">
<h2>Additional Comments</h2>
<p>In panel data applications, an additional consideration that arises with time-varying covariates is that they could be affected by the treatment, often referred to as a <span class="highlight">“bad control”</span></p>
<ul>
<li>In fact, I sneaked an example of this earlier: a person’s occupation</li>
</ul>
<p>In my view, a good default option for dealing with a covariate that could be affected by the treatment is to include its pre-treatment value</p>
<ul>
<li>Note: this is different from the traditional approach of excluding it altogether in a TWFE regression</li>
</ul>
<div class="fragment">
<p>What about time-varying covariates not affected by the treatment? Most important: include it’s level in some period (or average across periods), can also include more periods and/or differences over time, etc.</p>
</div>
</section>
<section id="back-to-minimum-wage-example" class="slide level2">
<h2>Back to Minimum Wage Example</h2>
<p>We’ll allow for path of outcomes to depend on region of the country</p>
<div class="cell">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">post</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.008)</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Relative to previous results, this is much smaller and statistically insignificant and is similar to the result in Dube et al.&nbsp;(2010).</p>
</section>
<section id="use-doubly-robust-approach-from-cs" class="slide level2">
<h2>Use Doubly Robust Approach from CS</h2>
</section>
<section id="use-doubly-robust-approach-from-cs-1" class="slide level2">
<h2>Use Doubly Robust Approach from CS</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aggte(MP = cs_x, type = "group")

Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; 


Overall summary of ATT's based on group/cohort aggregation:  
     ATT    Std. Error     [ 95%  Conf. Int.]  
 -0.0273        0.0077    -0.0424     -0.0121 *


Group Effects:
 Group Estimate Std. Error [95% Simult.  Conf. Band]  
  2004  -0.0436     0.0199       -0.0849     -0.0024 *
  2006  -0.0199     0.0078       -0.0360     -0.0038 *
---
Signif. codes: `*' confidence band does not cover 0

Control Group:  Never Treated,  Anticipation Periods:  0
Estimation Method:  Doubly Robust</code></pre>
</div>
</div>
</section>
<section id="comments-1" class="slide level2">
<h2>Comments</h2>
<p>Even more than in the previous case, the results in this case are notably different depending on the estimation strategy.</p>
<p>name: violations</p>
</section>
<section id="what-about-violations-of-parallel-trends" class="slide level2">
<h2>What about violations of parallel trends?</h2>
<p>Parallel trends assumptions don’t automatically hold in applications with repeated observations over time.</p>
<div class="fragment">
<p>The most natural way to motivate parallel trends is with a linear model for untreated potential outcomes: <span class="math display">\[\begin{align*}
  Y_{it}(0) = \theta_t + \eta_i + e_{it}
\end{align*}\]</span> where the key feature is the additive separability of <span class="math inline">\(\eta_i\)</span></p>
</div>
<div class="fragment">
<p>But it’s not always clear if additive separability (and hence parallel trends) is reasonable</p>
<ul>
<li>The most common “response” is pre-testing…checking if parallel trends holds in pre-treatment periods</li>
</ul>
</div>
<div class="fragment">
<p>DID + pre-tests are a very powerful/useful approach to “validating” the parallel trends assumption</p>
</div>
</section>
<section id="what-about-our-case" class="slide level2">
<h2>What about our case?</h2>

<img data-src="Relaxing-Parallel-Trends_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch quarto-figure-center"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Relaxing-Parallel-Trends_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>